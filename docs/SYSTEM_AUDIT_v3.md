# 系统审查报告 v3.0

## 审查日期：2026-01-09

## 一、问题清单与修复状态

### 1. ✅ Admin后台【依赖关系】【训练计划】UI错误
**问题描述**：
- 训练计划页面缺少 AdminNav 导航组件
- 依赖关系页面描述过于简单

**修复内容**：
- 为训练计划页面添加 AdminNav 和详细描述
- 优化依赖关系页面描述内容

### 2. ✅ 助教管理页面功能不完整
**问题描述**：
- 无法编辑助教的 name、wechatQrcode 字段
- 助教端没有个人信息页面
- 二维码无法上传

**修复内容**：
- 扩展 admin/coaches 页面支持编辑 name、wechatQrcode
- 创建助教端 /coach/profile 页面
- 更新 API 支持字段更新
- 添加密码修改功能

### 3. ✅ 数据看板无法查看明细
**问题描述**：
- 数据汇总无法点击查看明细数据
- 缺少钻取功能

**修复内容**：
- 为统计数据添加点击交互
- 添加明细弹窗和跳转链接
- 画像/阶段分布支持点击筛选

### 4. ✅ 画像标签显示为"推进方式"
**问题描述**：
- 标签管理页面显示的标签名称与预期不符
- `tag-display.ts` 中 ARCHETYPE_DISPLAY 的 labelCn 使用了"推进方式"而非"画像"

**修复内容**：
- 修正 tag-display.ts 中的标签显示名称为"画像：xxx型"
- 更新标签管理页面的预定义标签

### 5. ✅ 页面描述内容过于简单
**问题描述**：
- 页面描述如"统一管理陪跑策略与关联话术"对新用户不友好
- 缺少详细的使用说明

**修复内容**：
- 优化数据看板页面描述
- 优化策略中心页面描述
- 优化依赖关系页面描述
- 优化SOP配置页面描述
- 优化话术库页面描述
- 优化标签管理页面描述
- 优化训练计划页面描述
- 优化助教管理页面描述

### 6. ✅ 数据库字段审查
**检查结果**：
- 所有字段均在使用中，无冗余
- 字段命名一致性良好
- 详见 docs/SYSTEM_STRUCTURE_AND_CONTENT.md

---

## 二、数据库字段与代码对应关系

### User 表
| 字段 | 用途 | 代码使用位置 | 状态 |
|------|------|-------------|------|
| id | 主键 | 全局 | ✅ |
| role | 角色 | authz.ts | ✅ |
| username | 用户名 | 登录/显示 | ✅ |
| passwordHash | 密码 | 登录 | ✅ |
| status | 状态 | 权限控制 | ✅ |
| name | 显示名称 | 结果页/助教信息 | ✅ |
| wechatQrcode | 微信二维码 | 结果页 | ⚠️ 无编辑入口 |

### 标签系统
| 标签前缀 | 用途 | 显示名称 | 状态 |
|----------|------|----------|------|
| image: | 画像标签 | 推进方式:xxx | ⚠️ 需修正 |
| stability: | 稳定性 | 回答集中度 | ✅ |
| phase: | 阶段 | 完成状态 | ✅ |
| rule/risk/emotion等 | 行为标签 | xxx:偏高/中等/偏低 | ✅ |
| coach: | 助教标签 | 助教标记 | ✅ |

---

## 三、页面功能说明优化建议

### Admin 端

#### 数据看板
- **是什么**：系统核心运营指标的可视化展示
- **有什么用**：帮助管理员快速了解系统运营状况，包括邀请转化率、测评完成率、助教效能等
- **怎么使用**：
  1. 选择时间范围查看不同周期的数据
  2. 点击具体数据可查看明细
  3. 关注转化漏斗找出优化点

#### 策略中心
- **是什么**：陪跑策略的统一配置管理平台
- **有什么用**：定义不同阶段的陪跑策略，关联话术模板，实现标签驱动的智能推荐
- **怎么使用**：
  1. 按阶段（认知期/行动期/巩固期）查看策略
  2. 点击策略查看详情和影响范围
  3. 关联话术模板到对应策略

#### 依赖关系
- **是什么**：SOP、话术、标签之间关联关系的可视化工具
- **有什么用**：帮助理解配置之间的依赖，发现潜在冲突，优化配置结构
- **怎么使用**：
  1. 选择类型筛选查看特定配置
  2. 点击"冲突检测"发现配置问题
  3. 查看每个节点的关联关系

#### 标签管理
- **是什么**：系统所有标签的统一管理中心
- **有什么用**：查看标签定义、使用统计，理解标签含义
- **怎么使用**：
  1. 按分类筛选标签
  2. 搜索特定标签
  3. 查看标签使用次数

#### 训练计划
- **是什么**：客户行为训练计划的配置工具
- **有什么用**：创建多天训练计划，配置每日任务，跟踪客户训练进度
- **怎么使用**：
  1. 创建训练计划，设置天数
  2. 为每天添加任务（阅读/反思/行动）
  3. 查看报名和完成情况

### 助教端

#### 参与者档案
- **是什么**：助教管理的所有客户档案列表
- **有什么用**：查看客户信息、测评状态，进行跟进管理
- **怎么使用**：
  1. 使用筛选器找到目标客户
  2. 批量操作添加标签
  3. 点击查看进入详情页

---

## 四、修复任务清单

1. [x] 创建审查报告
2. [x] 修复训练计划页面 UI（添加AdminNav和描述）
3. [x] 修复依赖关系页面 UI（优化描述）
4. [x] 扩展助教管理页面功能（编辑name/wechatQrcode）
5. [x] 创建助教个人信息页面（/coach/profile）
6. [x] 修正标签显示名称（画像→推进方式问题）
7. [x] 添加数据看板明细查看功能
8. [x] 优化所有页面描述内容
9. [x] 创建系统功能与内容依赖结构文档
10. [x] 数据库字段审查（无冗余字段）

## 五、新增文件清单

| 文件路径 | 说明 |
|----------|------|
| `app/coach/profile/page.tsx` | 助教个人信息页面 |
| `app/api/coach/profile/route.ts` | 助教信息API |
| `app/api/coach/profile/password/route.ts` | 助教密码修改API |
| `docs/SYSTEM_STRUCTURE_AND_CONTENT.md` | 系统功能与内容依赖结构文档 |

## 六、修改文件清单

| 文件路径 | 修改内容 |
|----------|----------|
| `app/admin/training/page.tsx` | 添加AdminNav，优化描述 |
| `app/admin/strategy/dependencies/page.tsx` | 优化页面描述 |
| `app/admin/strategy/page.tsx` | 优化页面描述 |
| `app/admin/coaches/page.tsx` | 添加编辑功能（name/wechatQrcode） |
| `app/admin/dashboard/page.tsx` | 添加明细查看功能，优化描述 |
| `app/admin/tags/page.tsx` | 优化描述，更新预定义标签 |
| `app/admin/sop/page.tsx` | 优化页面描述 |
| `app/admin/scripts/page.tsx` | 优化页面描述 |
| `app/api/admin/coaches/route.ts` | 返回name/wechatQrcode字段 |
| `app/api/admin/coaches/[id]/route.ts` | 支持更新name/wechatQrcode |
| `app/coach/_components/CoachNav.tsx` | 添加个人信息导航入口 |
| `lib/tag-display.ts` | 修正画像标签显示名称 |
