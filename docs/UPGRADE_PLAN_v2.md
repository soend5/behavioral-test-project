# å‡çº§è®¡åˆ’ v2.0

> åŸºäºã€Šæ·±åº¦ä½“éªŒå®¡è®¡æŠ¥å‘Š v2.0ã€‹åˆ¶å®š
> æ—¥æœŸï¼š2026-01-09
> æ ¸å¿ƒåŸåˆ™ï¼šç”¨æˆ·ç«¯ç§»åŠ¨ä¼˜å…ˆï¼ŒåŠ©æ•™/Adminç«¯Webä¼˜å…ˆ+ç§»åŠ¨ç«¯å±•ç¤ºé‡ç‚¹

---

## ä¸€ã€ç‰ˆæœ¬è§„åˆ’æ€»è§ˆ

| ç‰ˆæœ¬ | å‘¨æœŸ | ä¸»é¢˜ | æ ¸å¿ƒç›®æ ‡ |
|------|------|------|----------|
| v1.9 | 1å‘¨ | Quick Wins | å¯¼èˆªé‡ç»„+ä¿¡æ¯åˆ†å±‚+å…¥å£ä¼˜åŒ– |
| v2.0 | 2å‘¨ | ç­–ç•¥ä¸­å¿ƒ | SOP+è¯æœ¯åˆå¹¶+é…ç½®é¢„è§ˆ |
| v2.1 | 2å‘¨ | åŠ©æ•™æ•ˆèƒ½ | ç­›é€‰å™¨+æ‰¹é‡æ“ä½œ+ç§»åŠ¨é€‚é… |
| v2.2 | 2å‘¨ | ç³»ç»Ÿå¥å£® | é…ç½®ç‰ˆæœ¬+æƒé™æ‰©å±•+ç›‘æ§ |

**æ€»å‘¨æœŸï¼š7å‘¨**

---

## äºŒã€ç»ˆç«¯é€‚é…ç­–ç•¥

### ç”¨æˆ·ç«¯ï¼ˆå®¢æˆ·ï¼‰- ç§»åŠ¨ç«¯ä¼˜å…ˆ

| é¡µé¢ | ç§»åŠ¨ç«¯ä¼˜åŒ–é‡ç‚¹ | ä¼˜å…ˆçº§ |
|------|----------------|--------|
| è½åœ°é¡µ /t/[token] | é¦–å±å®Œæ•´å±•ç¤ºä»·å€¼ä¸»å¼ +å¼€å§‹æŒ‰é’® | P0 |
| æµ‹è¯„é¡µ /t/[token]/quiz | å¤§æŒ‰é’®+è¿›åº¦æ¡+å•é¢˜å•å± | P0 |
| ç»“æœé¡µ /t/[token]/result | é¦–å±ï¼šç”»åƒ+æ ¸å¿ƒæ´å¯Ÿ+è”ç³»åŠ©æ•™ | P0 |
| è®­ç»ƒé¡µ /t/[token]/training | å¡ç‰‡å¼ä»»åŠ¡åˆ—è¡¨+å¤§æŒ‰é’® | P1 |

### åŠ©æ•™ç«¯ - Webä¼˜å…ˆï¼Œç§»åŠ¨ç«¯å±•ç¤ºé‡ç‚¹

| é¡µé¢ | Webç«¯å®Œæ•´åŠŸèƒ½ | ç§»åŠ¨ç«¯ç²¾ç®€å±•ç¤º |
|------|---------------|----------------|
| ä»ªè¡¨ç›˜ /coach/dashboard | å¾…åŠ+å®¢æˆ·åˆ—è¡¨+ç­›é€‰ | å¾…åŠåˆ—è¡¨+å¿«é€Ÿæ“ä½œ |
| å®¢æˆ·è¯¦æƒ… /coach/clients/[id] | å…¨éƒ¨ä¿¡æ¯+è¯æœ¯+è·Ÿè¿› | å…³é”®ä¿¡æ¯å¡ç‰‡+ä¸€é”®è¯æœ¯ |
| é‚€è¯·ç®¡ç† /coach/invites | åˆ—è¡¨+åˆ›å»º+çŠ¶æ€ | å¿«é€Ÿåˆ›å»º+çŠ¶æ€æŸ¥çœ‹ |

### Adminç«¯ - Webä¼˜å…ˆï¼Œç§»åŠ¨ç«¯åªè¯»

| é¡µé¢ | Webç«¯å®Œæ•´åŠŸèƒ½ | ç§»åŠ¨ç«¯ |
|------|---------------|--------|
| æ•°æ®çœ‹æ¿ | å®Œæ•´å›¾è¡¨+ç­›é€‰ | æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡ |
| ç­–ç•¥ä¸­å¿ƒ | å®Œæ•´é…ç½® | åªè¯»æŸ¥çœ‹ |
| å†…å®¹ç®¡ç† | å®Œæ•´ç¼–è¾‘ | åªè¯»æŸ¥çœ‹ |

---

## ä¸‰ã€v1.9 Quick Winsï¼ˆ1å‘¨ï¼‰

### ç›®æ ‡
- Admin å¯¼èˆªå®Œæ•´åº¦ 100%
- åŠ©æ•™è¯æœ¯ä½¿ç”¨ç‡ +20%
- é…ç½®ç†è§£æˆæœ¬é™ä½ 50%

### 3.1 Admin å¯¼èˆªé‡ç»„

**å½“å‰é—®é¢˜**ï¼šæ•°æ®çœ‹æ¿ã€è¯æœ¯åº“ã€è®­ç»ƒè®¡åˆ’ä¸åœ¨å¯¼èˆªä¸­

**æ”¹åŠ¨æ–‡ä»¶**ï¼š`app/admin/_components/AdminNav.tsx`

```tsx
// æ”¹å‰
const navItems: NavItem[] = [
  { href: "/admin", label: "æ€»è§ˆ" },
  { href: "/admin/settings", label: "ç³»ç»Ÿè®¾ç½®" },
  { href: "/admin/quiz", label: "é¢˜åº“" },
  { href: "/admin/sop", label: "SOP é…ç½®" },
  { href: "/admin/archetypes", label: "ç”»åƒæ–‡æ¡ˆ" },
  { href: "/admin/training-handbook", label: "å†…è®­æ‰‹å†Œ" },
  { href: "/admin/methodology", label: "æ–¹æ³•è®º" },
  { href: "/admin/coaches", label: "åŠ©æ•™è´¦å·" },
  { href: "/admin/audit", label: "å®¡è®¡æ—¥å¿—" }
];

// æ”¹åï¼ˆæŒ‰èŒè´£åˆ†ç»„ï¼‰
const navGroups = [
  {
    label: "è¿è¥",
    items: [
      { href: "/admin/dashboard", label: "ğŸ“Š æ•°æ®çœ‹æ¿" },
    ]
  },
  {
    label: "ç­–ç•¥",
    items: [
      { href: "/admin/sop", label: "ğŸ¯ SOPé…ç½®" },
      { href: "/admin/scripts", label: "ğŸ’¬ è¯æœ¯åº“" },
      { href: "/admin/training", label: "ğŸ“… è®­ç»ƒè®¡åˆ’" },
    ]
  },
  {
    label: "å†…å®¹",
    items: [
      { href: "/admin/quiz", label: "ğŸ“ é¢˜åº“" },
      { href: "/admin/archetypes", label: "ğŸ‘¤ ç”»åƒæ–‡æ¡ˆ" },
      { href: "/admin/training-handbook", label: "ğŸ“š å†…è®­æ‰‹å†Œ" },
      { href: "/admin/methodology", label: "ğŸ“– æ–¹æ³•è®º" },
    ]
  },
  {
    label: "ç®¡ç†",
    items: [
      { href: "/admin/coaches", label: "ğŸ‘¥ åŠ©æ•™è´¦å·" },
      { href: "/admin/settings", label: "âš™ï¸ ç³»ç»Ÿè®¾ç½®" },
      { href: "/admin/audit", label: "ğŸ“‹ å®¡è®¡æ—¥å¿—" },
    ]
  },
];
```

**å·¥æ—¶**ï¼š0.5å¤©

### 3.2 Admin é¦–é¡µæ”¹ä¸ºæ•°æ®çœ‹æ¿

**æ”¹åŠ¨**ï¼š`app/admin/page.tsx` é‡å®šå‘åˆ° `/admin/dashboard`

```tsx
// app/admin/page.tsx
import { redirect } from "next/navigation";

export default function AdminPage() {
  redirect("/admin/dashboard");
}
```

**å·¥æ—¶**ï¼š0.5å¤©

### 3.3 åŠ©æ•™ç«¯å®¢æˆ·è¯¦æƒ…é¡µä¿¡æ¯åˆ†å±‚

**å½“å‰é—®é¢˜**ï¼šä¿¡æ¯å¹³é“ºï¼Œå…³é”®ä¿¡æ¯è¢«æ·¹æ²¡

**æ”¹åŠ¨æ–‡ä»¶**ï¼š`app/coach/clients/[id]/page.tsx`

**æ–°å¸ƒå±€ï¼ˆç§»åŠ¨ç«¯é€‚é…ï¼‰**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“± ç§»åŠ¨ç«¯å¸ƒå±€ï¼ˆå•åˆ—ï¼‰                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ å…³é”®ä¿¡æ¯å¡ç‰‡ï¼ˆå›ºå®šé¡¶éƒ¨ï¼‰                                  â”‚ â”‚
â”‚ â”‚ ç”»åƒï¼šè§„åˆ™æ‰§è¡Œå‹ | é˜¶æ®µï¼šè®¤çŸ¥æœŸ | åˆ†å±‚ï¼šé«˜æ½œåŠ›            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ’¬ ä¸€é”®è¯æœ¯ï¼ˆç½®é¡¶ï¼‰                                       â”‚ â”‚
â”‚ â”‚ [æ¨èè¯æœ¯1] [å¤åˆ¶]                                       â”‚ â”‚
â”‚ â”‚ [æ¨èè¯æœ¯2] [å¤åˆ¶]                                       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ¯ é™ªè·‘å»ºè®®ï¼ˆç²¾ç®€ç‰ˆï¼‰                                     â”‚ â”‚
â”‚ â”‚ ç›®æ ‡ï¼šå»ºç«‹ä¿¡ä»» | ç­–ç•¥ï¼šäº†è§£éœ€æ±‚                           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“ å¿«é€Ÿè®°å½•                                              â”‚ â”‚
â”‚ â”‚ [å¾®ä¿¡] [ç”µè¯] [å¤‡æ³¨] + è¾“å…¥æ¡†                            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚ â–¼ æ›´å¤šä¿¡æ¯ï¼ˆæŠ˜å ï¼‰                                          â”‚
â”‚   - å‚ä¸è€…ä¿¡æ¯                                              â”‚
â”‚   - æµ‹è¯„è¯¦æƒ…                                                â”‚
â”‚   - æµ‹è¯„æ—¶é—´çº¿                                              â”‚
â”‚   - æ ‡ç­¾ç®¡ç†                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å·¥æ—¶**ï¼š1.5å¤©

### 3.4 è¯æœ¯é¢æ¿ä¼˜åŒ–

**æ”¹åŠ¨æ–‡ä»¶**ï¼š`app/coach/clients/[id]/_components/ScriptPanel.tsx`

**ä¼˜åŒ–ç‚¹**ï¼š
1. ç§»åˆ°é¡µé¢é¡¶éƒ¨ä½ç½®
2. å¢åŠ "æ™ºèƒ½æ¨è"æ ‡è®°
3. å¤åˆ¶åè‡ªåŠ¨è®°å½•ä½¿ç”¨æ—¥å¿—
4. ç§»åŠ¨ç«¯ï¼šå¤§æŒ‰é’®+å…¨å®½æ˜¾ç¤º

```tsx
// ç§»åŠ¨ç«¯é€‚é…æ ·å¼
<div className="bg-white rounded-lg shadow p-4 lg:p-6">
  <h3 className="font-semibold mb-3 flex items-center gap-2">
    ğŸ’¬ ä¸€é”®è¯æœ¯
    <span className="text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded">
      æ™ºèƒ½æ¨è
    </span>
  </h3>
  
  {/* æ¨èè¯æœ¯ï¼ˆç§»åŠ¨ç«¯å¤§æŒ‰é’®ï¼‰ */}
  {recommended.map(script => (
    <div key={script.id} className="p-3 lg:p-4 border rounded-lg mb-2 bg-blue-50">
      <div className="flex justify-between items-start gap-2">
        <span className="font-medium text-sm lg:text-base">{script.name}</span>
        <button
          onClick={() => copyScript(script)}
          className="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm 
                     min-w-[80px] active:bg-blue-700"
        >
          {copied === script.id ? 'å·²å¤åˆ¶ âœ“' : 'å¤åˆ¶'}
        </button>
      </div>
      <p className="text-sm text-gray-600 mt-2 line-clamp-2 lg:line-clamp-3">
        {renderContent(script.content)}
      </p>
    </div>
  ))}
</div>
```

**å·¥æ—¶**ï¼š1å¤©

### 3.5 å¾…åŠé¢æ¿é»˜è®¤å±•å¼€

**æ”¹åŠ¨æ–‡ä»¶**ï¼š`app/coach/_components/TodoPanel.tsx`

```tsx
// æ”¹å‰
const [expanded, setExpanded] = useState(false);

// æ”¹å
const [expanded, setExpanded] = useState(true);
```

**å·¥æ—¶**ï¼š0.5å¤©

### 3.6 åˆè§„æç¤ºä¼˜åŒ–

**æ”¹åŠ¨æ–‡ä»¶**ï¼š`lib/ui-copy.ts` + ç›¸å…³é¡µé¢

```typescript
// æ”¹å‰
export const COMPLIANCE_NOTICE_CN = 
  "æœ¬æµ‹è¯„åŠç»“æœç”¨äºç”Ÿæˆè¡Œä¸ºç»“æ„ç”»åƒä¸æ²Ÿé€šå»ºè®®å‚è€ƒï¼Œä¸æ„æˆæŠ•èµ„é¡¾é—®æœåŠ¡æˆ–ä»»ä½•ä¹°å–å»ºè®®ï¼Œä¸æ‰¿è¯ºæ”¶ç›Šã€‚";

// æ”¹åï¼ˆåˆ†åœºæ™¯ï¼‰
export const COMPLIANCE_NOTICES = {
  coach_panel: "ä»¥ä¸‹ä¸ºæ²Ÿé€šå‚è€ƒï¼Œè¯·å‹¿ä½œä¸ºæŠ•èµ„å»ºè®®",
  result_page: "è¿™æ˜¯ä½ çš„è¡Œä¸ºç»“æ„ç”»åƒï¼Œç”¨äºå’ŒåŠ©æ•™å¯¹é½ä¸‹ä¸€æ­¥",
  landing_page: "æœ¬æµ‹è¯„å¸®ä½ çœ‹æ¸…æ“ä½œä¹ æƒ¯ï¼Œä¸æ¶‰åŠæŠ•èµ„å»ºè®®",
};
```

**å·¥æ—¶**ï¼š0.5å¤©

### 3.7 SOP/è¯æœ¯é¡µé¢æ–‡æ¡ˆä¼˜åŒ–

**æ”¹åŠ¨æ–‡ä»¶**ï¼š
- `app/admin/sop/page.tsx`
- `app/admin/scripts/page.tsx`

| æ”¹å‰ | æ”¹å |
|------|------|
| SOP é…ç½®ç®¡ç† | é™ªè·‘ç­–ç•¥é…ç½® |
| SOP å®šä¹‰ | ç­–ç•¥å†…å®¹ |
| åŒ¹é…è§„åˆ™ | è§¦å‘æ¡ä»¶ |
| è¯æœ¯åº“ç®¡ç† | æ²Ÿé€šè¯æœ¯åº“ |
| è§¦å‘æ ‡ç­¾ | é€‚ç”¨åœºæ™¯ |

**å·¥æ—¶**ï¼š0.5å¤©

### v1.9 ä»»åŠ¡æ¸…å•

| ä»»åŠ¡ | å·¥æ—¶ | è´Ÿè´£ | éªŒæ”¶æŒ‡æ ‡ |
|------|------|------|----------|
| Admin å¯¼èˆªé‡ç»„ | 0.5d | å‰ç«¯ | æ‰€æœ‰é¡µé¢å¯ä»å¯¼èˆªè®¿é—® |
| Admin é¦–é¡µæ”¹ä¸ºæ•°æ®çœ‹æ¿ | 0.5d | å‰ç«¯ | ç™»å½•åç›´è¾¾çœ‹æ¿ |
| å®¢æˆ·è¯¦æƒ…é¡µä¿¡æ¯åˆ†å±‚ | 1.5d | å‰ç«¯ | å…³é”®ä¿¡æ¯é¦–å±å¯è§ |
| è¯æœ¯é¢æ¿ä¼˜åŒ– | 1d | å‰ç«¯ | è¯æœ¯ä½¿ç”¨ç‡+20% |
| å¾…åŠé¢æ¿é»˜è®¤å±•å¼€ | 0.5d | å‰ç«¯ | å“åº”æ—¶é—´-15% |
| åˆè§„æç¤ºä¼˜åŒ– | 0.5d | å‰ç«¯ | åŠ©æ•™å‹åŠ›æ„Ÿé™ä½ |
| SOP/è¯æœ¯æ–‡æ¡ˆä¼˜åŒ– | 0.5d | å‰ç«¯ | ç†è§£æˆæœ¬é™ä½ |
| **æ€»è®¡** | **5d** | | |

---

## å››ã€v2.0 ç­–ç•¥ä¸­å¿ƒï¼ˆ2å‘¨ï¼‰

### ç›®æ ‡
- é…ç½®å…¥å£ä» 4 ä¸ªå‡å°‘åˆ° 2 ä¸ª
- é…ç½®å†²çªç‡ -80%
- æ¶ˆé™¤ SOP Rule å’Œè¯æœ¯ triggerTags çš„é‡å¤é…ç½®

### 4.1 ç­–ç•¥ä¸­å¿ƒé¡µé¢

**æ–°å»ºæ–‡ä»¶**ï¼š`app/admin/strategy/page.tsx`

**è®¾è®¡ç†å¿µ**ï¼š
- SOP Definition ä½œä¸º"ç­–ç•¥"
- SOP Rule ä½œä¸º"è§¦å‘æ¡ä»¶"
- è¯æœ¯ä½œä¸º"æ‰§è¡Œå†…å®¹"ï¼Œå…³è”åˆ° SOP

**é¡µé¢ç»“æ„**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç­–ç•¥ä¸­å¿ƒ                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ç­–ç•¥åˆ—è¡¨ï¼ˆå·¦ä¾§ï¼‰                                             â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â–¼ è®¤çŸ¥å»ºç«‹æœŸ (pre)                                          â”‚ â”‚
â”‚ â”‚   â”œâ”€â”€ ä¿¡ä»»å»ºç«‹ç­–ç•¥ [3æ¡è§„åˆ™] [5æ¡è¯æœ¯]                       â”‚ â”‚
â”‚ â”‚   â””â”€â”€ éœ€æ±‚äº†è§£ç­–ç•¥ [2æ¡è§„åˆ™] [3æ¡è¯æœ¯]                       â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â–¼ è¡ŒåŠ¨æ¨è¿›æœŸ (mid)                                          â”‚ â”‚
â”‚ â”‚   â”œâ”€â”€ æ–¹æ¡ˆæ²Ÿé€šç­–ç•¥ [2æ¡è§„åˆ™] [4æ¡è¯æœ¯]                       â”‚ â”‚
â”‚ â”‚   â””â”€â”€ ç–‘è™‘è§£ç­”ç­–ç•¥ [1æ¡è§„åˆ™] [2æ¡è¯æœ¯]                       â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â–¼ æˆæœå·©å›ºæœŸ (post)                                         â”‚ â”‚
â”‚ â”‚   â””â”€â”€ è·Ÿè¿›æ”¯æŒç­–ç•¥ [2æ¡è§„åˆ™] [3æ¡è¯æœ¯]                       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ç­–ç•¥è¯¦æƒ…ï¼ˆå³ä¾§ï¼‰                                             â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ ç­–ç•¥åç§°ï¼šä¿¡ä»»å»ºç«‹ç­–ç•¥                                       â”‚ â”‚
â”‚ â”‚ é˜¶æ®µï¼šè®¤çŸ¥å»ºç«‹æœŸ (pre)                                       â”‚ â”‚
â”‚ â”‚ çŠ¶æ€ï¼šå¯ç”¨                                                   â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚ â”‚ ğŸ“‹ ç­–ç•¥å†…å®¹                                                  â”‚ â”‚
â”‚ â”‚ çŠ¶æ€åˆ¤æ–­ï¼šå®¢æˆ·å¤„äºè®¤çŸ¥å»ºç«‹æœŸï¼Œéœ€è¦å»ºç«‹ä¿¡ä»»                    â”‚ â”‚
â”‚ â”‚ æ ¸å¿ƒç›®æ ‡ï¼šå»ºç«‹ä¿¡ä»»ï¼Œäº†è§£å®¢æˆ·çœŸå®éœ€æ±‚                          â”‚ â”‚
â”‚ â”‚ æ¨èç­–ç•¥ï¼šå»ºç«‹ä¿¡ä»»ã€äº†è§£éœ€æ±‚ã€æä¾›ä»·å€¼                        â”‚ â”‚
â”‚ â”‚ ç¦ç”¨è¡Œä¸ºï¼šè¿‡åº¦æ¨é”€ã€æ‰¿è¯ºæ”¶ç›Šã€æ–½åŠ å‹åŠ›                        â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚ â”‚ ğŸ¯ è§¦å‘æ¡ä»¶ï¼ˆåŸ SOP Ruleï¼‰                                   â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ è§„åˆ™1ï¼šè§„åˆ™æ‰§è¡Œå‹ + ä½ç¨³å®šæ€§                              â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ å¿…é¡»æ ‡ç­¾ï¼šimage:rule_executor, stability:low            â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ æ’é™¤æ ‡ç­¾ï¼šcoach:high_value                              â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ ç½®ä¿¡åº¦ï¼š80                                               â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ [+ æ·»åŠ è§¦å‘æ¡ä»¶]                                            â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚ â”‚ ğŸ’¬ å…³è”è¯æœ¯                                                  â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ é¦–æ¬¡æ²Ÿé€š-è§„åˆ™æ‰§è¡Œå‹                                       â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ "{{customerName}}ä½ å¥½ï¼Œçœ‹äº†ä½ çš„æµ‹è¯„ç»“æœ..."               â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ ä½¿ç”¨æ¬¡æ•°ï¼š23                                              â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ [+ æ·»åŠ è¯æœ¯] [ä»è¯æœ¯åº“é€‰æ‹©]                                  â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚ â”‚ ğŸ“Š å½±å“é¢„è§ˆ                                                  â”‚ â”‚
â”‚ â”‚ å½“å‰é…ç½®å°†å½±å“ï¼šçº¦ 156 ä¸ªå®¢æˆ·                                â”‚ â”‚
â”‚ â”‚ ç”»åƒåˆ†å¸ƒï¼šè§„åˆ™æ‰§è¡Œå‹ 45%ï¼Œå†²åŠ¨ååº”å‹ 30%ï¼Œå…¶ä»– 25%           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å·¥æ—¶**ï¼š5å¤©

### 4.2 æ•°æ®æ¨¡å‹è°ƒæ•´

**ä¿®æ”¹æ–‡ä»¶**ï¼š`prisma/schema.prisma`

```prisma
// è¯æœ¯å…³è”åˆ° SOPï¼ˆæ–°å¢å­—æ®µï¼‰
model ScriptTemplate {
  id               String   @id @default(cuid())
  name             String
  category         String
  sopId            String?  @map("sop_id")  // æ–°å¢ï¼šå…³è” SOP
  // ... å…¶ä»–å­—æ®µä¿æŒä¸å˜
  
  sop              SopDefinition? @relation(fields: [sopId], references: [sopId])
  
  @@index([sopId])
  @@map("script_templates")
}

model SopDefinition {
  // ... ç°æœ‰å­—æ®µ
  
  scripts          ScriptTemplate[]  // æ–°å¢ï¼šå…³è”è¯æœ¯
}
```

**å·¥æ—¶**ï¼š1å¤©

### 4.3 é…ç½®å½±å“é¢„è§ˆ API

**æ–°å»ºæ–‡ä»¶**ï¼š`app/api/admin/strategy/preview/route.ts`

```typescript
// GET /api/admin/strategy/preview?sopId=xxx
// è¿”å›ï¼šè¯¥ SOP é…ç½®ä¼šå½±å“å¤šå°‘å®¢æˆ·

export async function GET(request: Request) {
  const { searchParams } = new URL(request.url);
  const sopId = searchParams.get("sopId");
  
  // è·å– SOP çš„æ‰€æœ‰è§„åˆ™
  const rules = await prisma.sopRule.findMany({
    where: { sopId, status: "active" },
  });
  
  // è·å–æ‰€æœ‰å®¢æˆ·çš„æœ€æ–°æµ‹è¯„
  const customers = await prisma.customer.findMany({
    include: {
      attempts: {
        where: { submittedAt: { not: null } },
        orderBy: { submittedAt: "desc" },
        take: 1,
      },
    },
  });
  
  // æ¨¡æ‹ŸåŒ¹é…
  let matchCount = 0;
  const archetypeDistribution: Record<string, number> = {};
  
  for (const customer of customers) {
    const attempt = customer.attempts[0];
    if (!attempt) continue;
    
    const tags = JSON.parse(attempt.tagsJson || "[]");
    const stage = attempt.stage;
    
    // æ£€æŸ¥æ˜¯å¦åŒ¹é…ä»»ä¸€è§„åˆ™
    for (const rule of rules) {
      if (matchRule(rule, stage, tags)) {
        matchCount++;
        // ç»Ÿè®¡ç”»åƒåˆ†å¸ƒ
        const archetype = tags.find((t: string) => t.startsWith("image:"));
        if (archetype) {
          archetypeDistribution[archetype] = (archetypeDistribution[archetype] || 0) + 1;
        }
        break;
      }
    }
  }
  
  return json({
    ok: true,
    data: {
      matchCount,
      totalCustomers: customers.length,
      archetypeDistribution,
    },
  });
}
```

**å·¥æ—¶**ï¼š1.5å¤©

### 4.4 è¯æœ¯åŒ¹é…é€»è¾‘é‡æ„

**ä¿®æ”¹æ–‡ä»¶**ï¼š`app/api/coach/scripts/route.ts`

```typescript
// æ”¹å‰ï¼šè¯æœ¯ç‹¬ç«‹åŒ¹é…
// æ”¹åï¼šä¼˜å…ˆè¿”å›å…³è” SOP çš„è¯æœ¯ï¼Œå†è¿”å›ç‹¬ç«‹è¯æœ¯

export async function GET(request: Request) {
  const { searchParams } = new URL(request.url);
  const customerId = searchParams.get("customerId");
  
  // 1. è·å–å®¢æˆ·çš„ SOP åŒ¹é…ç»“æœ
  const customer = await getCustomerWithLatestAttempt(customerId);
  const matchedSop = await matchSOP(prisma, customer.stage, customer.tags);
  
  // 2. è·å–å…³è”è¯¥ SOP çš„è¯æœ¯
  const sopScripts = matchedSop
    ? await prisma.scriptTemplate.findMany({
        where: { sopId: matchedSop.sopId, status: "active" },
      })
    : [];
  
  // 3. è·å–ç‹¬ç«‹åŒ¹é…çš„è¯æœ¯ï¼ˆä½œä¸ºè¡¥å……ï¼‰
  const independentScripts = await prisma.scriptTemplate.findMany({
    where: {
      sopId: null,
      status: "active",
      // åŸæœ‰çš„ triggerTags åŒ¹é…é€»è¾‘
    },
  });
  
  // 4. åˆå¹¶å¹¶æ’åº
  const scripts = [
    ...sopScripts.map(s => ({ ...s, relevanceScore: 100 })),
    ...independentScripts.map(s => ({ ...s, relevanceScore: 50 })),
  ];
  
  return json({ ok: true, data: { scripts } });
}
```

**å·¥æ—¶**ï¼š1.5å¤©

### v2.0 ä»»åŠ¡æ¸…å•

| ä»»åŠ¡ | å·¥æ—¶ | è´Ÿè´£ | éªŒæ”¶æŒ‡æ ‡ |
|------|------|------|----------|
| ç­–ç•¥ä¸­å¿ƒé¡µé¢å¼€å‘ | 5d | å‰ç«¯ | ç»Ÿä¸€å…¥å£å¯ç”¨ |
| æ•°æ®æ¨¡å‹è°ƒæ•´ | 1d | åç«¯ | è¯æœ¯å¯å…³è” SOP |
| é…ç½®å½±å“é¢„è§ˆ API | 1.5d | åç«¯ | é¢„è§ˆå‡†ç¡®ç‡ >95% |
| è¯æœ¯åŒ¹é…é€»è¾‘é‡æ„ | 1.5d | åç«¯ | å…³è”è¯æœ¯ä¼˜å…ˆå±•ç¤º |
| åŸ SOP/è¯æœ¯é¡µé¢å…¼å®¹ | 1d | å‰ç«¯ | æ—§å…¥å£å¯ç”¨ |
| **æ€»è®¡** | **10d** | | |

---

## äº”ã€v2.1 åŠ©æ•™æ•ˆèƒ½ï¼ˆ2å‘¨ï¼‰

### ç›®æ ‡
- åŠ©æ•™ç­›é€‰æ•ˆç‡ +50%
- é«˜é£é™©ç”¨æˆ·å“åº”ç‡ +30%
- ç§»åŠ¨ç«¯åŠ©æ•™ä½“éªŒä¼˜åŒ–

### 5.1 å®¢æˆ·ç­›é€‰å™¨

**ä¿®æ”¹æ–‡ä»¶**ï¼š`app/coach/dashboard/page.tsx`

**ç­›é€‰ç»´åº¦**ï¼š
- åˆ†å±‚ï¼šé«˜æ½œåŠ› / éœ€å…³æ³¨ / æ´»è·ƒ / æ²‰é»˜ / æ–°å®¢æˆ·
- ç”»åƒï¼š6ç§ç”»åƒç±»å‹
- é˜¶æ®µï¼špre / mid / post
- æœ€è¿‘æ´»åŠ¨ï¼š7å¤©å†… / 14å¤©å†… / 30å¤©å†… / æ›´æ—©

**UIè®¾è®¡ï¼ˆç§»åŠ¨ç«¯é€‚é…ï¼‰**ï¼š

```tsx
// ç§»åŠ¨ç«¯ï¼šåº•éƒ¨æŠ½å±‰å¼ç­›é€‰
// Webç«¯ï¼šä¾§è¾¹æ ç­›é€‰

function CustomerFilter({ isMobile }: { isMobile: boolean }) {
  if (isMobile) {
    return (
      <Sheet>
        <SheetTrigger asChild>
          <button className="fixed bottom-4 right-4 w-14 h-14 bg-blue-600 
                           text-white rounded-full shadow-lg flex items-center 
                           justify-center text-xl">
            ğŸ”
          </button>
        </SheetTrigger>
        <SheetContent side="bottom" className="h-[60vh]">
          <FilterContent />
        </SheetContent>
      </Sheet>
    );
  }
  
  return (
    <div className="w-64 bg-white rounded-lg shadow p-4">
      <FilterContent />
    </div>
  );
}

function FilterContent() {
  return (
    <div className="space-y-4">
      <div>
        <label className="text-sm font-medium">å®¢æˆ·åˆ†å±‚</label>
        <div className="flex flex-wrap gap-2 mt-2">
          {SEGMENTS.map(seg => (
            <button
              key={seg.key}
              className={`px-3 py-1.5 rounded-full text-sm ${
                selected.includes(seg.key)
                  ? 'bg-blue-600 text-white'
                  : 'bg-gray-100 text-gray-700'
              }`}
            >
              {seg.name}
            </button>
          ))}
        </div>
      </div>
      
      <div>
        <label className="text-sm font-medium">ç”»åƒç±»å‹</label>
        <div className="flex flex-wrap gap-2 mt-2">
          {ARCHETYPES.map(arch => (
            <button key={arch.key} className="...">
              {arch.name}
            </button>
          ))}
        </div>
      </div>
      
      {/* æ›´å¤šç­›é€‰é¡¹ */}
    </div>
  );
}
```

**API æ”¹åŠ¨**ï¼š`app/api/coach/customers/route.ts`

```typescript
// æ–°å¢ç­›é€‰å‚æ•°
// GET /api/coach/customers?segment=high_potential&archetype=rule_executor&stage=pre

export async function GET(request: Request) {
  const { searchParams } = new URL(request.url);
  const segment = searchParams.get("segment");
  const archetype = searchParams.get("archetype");
  const stage = searchParams.get("stage");
  const activityDays = searchParams.get("activityDays");
  
  // æ„å»ºæŸ¥è¯¢æ¡ä»¶
  const where: Prisma.CustomerWhereInput = {
    coachId: session.user.id,
  };
  
  if (segment) {
    where.segments = {
      some: { segment },
    };
  }
  
  // ... å…¶ä»–ç­›é€‰æ¡ä»¶
}
```

**å·¥æ—¶**ï¼š3å¤©

### 5.2 é«˜é£é™©ç”¨æˆ·é¢„è­¦

**æ”¹åŠ¨ç‚¹**ï¼š
1. å®¢æˆ·åˆ—è¡¨ï¼šé«˜é£é™©ç”¨æˆ·çº¢è‰²è¾¹æ¡†
2. å®¢æˆ·è¯¦æƒ…ï¼šè¿›å…¥æ—¶å¼¹å‡ºæé†’
3. å¾…åŠé¢æ¿ï¼šé«˜é£é™©ç”¨æˆ·ç½®é¡¶

**ä¿®æ”¹æ–‡ä»¶**ï¼š
- `app/coach/dashboard/page.tsx`
- `app/coach/clients/[id]/page.tsx`
- `app/coach/_components/TodoPanel.tsx`

```tsx
// å®¢æˆ·åˆ—è¡¨ä¸­çš„é«˜é£é™©æ ‡è®°
function CustomerRow({ customer }: { customer: Customer }) {
  const isHighRisk = customer.segments?.some(
    s => s.segment === 'needs_attention'
  );
  
  return (
    <tr className={`border-b ${isHighRisk ? 'bg-red-50 border-l-4 border-l-red-500' : ''}`}>
      <td className="py-2 pr-2">
        <div className="flex items-center gap-2">
          {isHighRisk && (
            <span className="text-red-500" title="éœ€å…³æ³¨">âš ï¸</span>
          )}
          <span className="font-medium">
            {customer.nickname || customer.name || "æœªå‘½å"}
          </span>
        </div>
      </td>
      {/* ... */}
    </tr>
  );
}

// å®¢æˆ·è¯¦æƒ…é¡µçš„é«˜é£é™©æé†’
function HighRiskAlert({ customer }: { customer: Customer }) {
  const isHighRisk = customer.segments?.some(
    s => s.segment === 'needs_attention'
  );
  
  if (!isHighRisk) return null;
  
  return (
    <div className="bg-red-50 border border-red-200 rounded-lg p-4 mb-4">
      <div className="flex items-center gap-2 text-red-800">
        <span className="text-xl">âš ï¸</span>
        <span className="font-medium">éœ€å…³æ³¨å®¢æˆ·</span>
      </div>
      <p className="text-sm text-red-700 mt-1">
        è¯¥å®¢æˆ·ä¸ºå†²åŠ¨ååº”å‹æˆ–ç¨³å®šæ€§è¾ƒä½ï¼Œæ²Ÿé€šæ—¶è¯·æ³¨æ„ï¼š
      </p>
      <ul className="text-sm text-red-700 mt-2 list-disc pl-5">
        <li>é¿å…æ–½åŠ å‹åŠ›</li>
        <li>ä¸è¦å‚¬ä¿ƒå†³ç­–</li>
        <li>ä¿æŒè€å¿ƒå’Œç†è§£</li>
      </ul>
    </div>
  );
}
```

**å·¥æ—¶**ï¼š2å¤©

### 5.3 æ‰¹é‡æ“ä½œ

**åŠŸèƒ½**ï¼š
- æ‰¹é‡æ ‡è®°å·²å¤„ç†
- æ‰¹é‡åˆ›å»ºé‚€è¯·
- æ‰¹é‡æ·»åŠ æ ‡ç­¾

**UIè®¾è®¡**ï¼š

```tsx
// å®¢æˆ·åˆ—è¡¨å¢åŠ å¤šé€‰
function CustomerList() {
  const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set());
  const [selectMode, setSelectMode] = useState(false);
  
  return (
    <div>
      {/* æ‰¹é‡æ“ä½œæ  */}
      {selectedIds.size > 0 && (
        <div className="sticky top-0 bg-blue-600 text-white p-3 rounded-lg mb-4 
                      flex items-center justify-between">
          <span>å·²é€‰æ‹© {selectedIds.size} ä¸ªå®¢æˆ·</span>
          <div className="flex gap-2">
            <button className="px-3 py-1 bg-white/20 rounded">
              æ‰¹é‡åˆ›å»ºé‚€è¯·
            </button>
            <button className="px-3 py-1 bg-white/20 rounded">
              æ‰¹é‡æ·»åŠ æ ‡ç­¾
            </button>
            <button 
              onClick={() => setSelectedIds(new Set())}
              className="px-3 py-1 bg-white/20 rounded"
            >
              å–æ¶ˆ
            </button>
          </div>
        </div>
      )}
      
      {/* å®¢æˆ·åˆ—è¡¨ */}
      <table>
        <thead>
          <tr>
            <th className="w-10">
              <input
                type="checkbox"
                onChange={(e) => {
                  if (e.target.checked) {
                    setSelectedIds(new Set(customers.map(c => c.id)));
                  } else {
                    setSelectedIds(new Set());
                  }
                }}
              />
            </th>
            {/* ... */}
          </tr>
        </thead>
        <tbody>
          {customers.map(c => (
            <tr key={c.id}>
              <td>
                <input
                  type="checkbox"
                  checked={selectedIds.has(c.id)}
                  onChange={(e) => {
                    const newSet = new Set(selectedIds);
                    if (e.target.checked) {
                      newSet.add(c.id);
                    } else {
                      newSet.delete(c.id);
                    }
                    setSelectedIds(newSet);
                  }}
                />
              </td>
              {/* ... */}
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  );
}
```

**API**ï¼š`app/api/coach/customers/batch/route.ts`

```typescript
// POST /api/coach/customers/batch
// body: { action: 'create_invites' | 'add_tag', customerIds: string[], ... }
```

**å·¥æ—¶**ï¼š3å¤©

### 5.4 è·Ÿè¿›è®°å½•æ¨¡æ¿

**ä¿®æ”¹æ–‡ä»¶**ï¼š`app/coach/clients/[id]/_components/FollowUpSection.tsx`

```tsx
const FOLLOWUP_TEMPLATES = [
  { id: 'first_contact', label: 'é¦–æ¬¡æ²Ÿé€š', content: 'é¦–æ¬¡æ²Ÿé€šï¼Œäº†è§£å®¢æˆ·éœ€æ±‚...' },
  { id: 'followup', label: 'è·Ÿè¿›æ²Ÿé€š', content: 'è·Ÿè¿›ä¸Šæ¬¡æ²Ÿé€šå†…å®¹...' },
  { id: 'training_remind', label: 'è®­ç»ƒæé†’', content: 'æé†’å®¢æˆ·å®Œæˆä»Šæ—¥è®­ç»ƒä»»åŠ¡...' },
  { id: 'retest_invite', label: 'å¤æµ‹é‚€è¯·', content: 'é‚€è¯·å®¢æˆ·è¿›è¡Œå¤æµ‹...' },
];

function FollowUpSection({ customerId }: Props) {
  const [showTemplates, setShowTemplates] = useState(false);
  
  return (
    <div>
      {/* æ¨¡æ¿é€‰æ‹© */}
      <div className="flex gap-2 mb-2 overflow-x-auto pb-2">
        {FOLLOWUP_TEMPLATES.map(tpl => (
          <button
            key={tpl.id}
            onClick={() => {
              setNewLog(p => ({ ...p, content: tpl.content }));
            }}
            className="px-3 py-1.5 bg-gray-100 rounded-full text-sm whitespace-nowrap
                     hover:bg-gray-200 active:bg-gray-300"
          >
            {tpl.label}
          </button>
        ))}
      </div>
      
      {/* åŸæœ‰çš„è¾“å…¥è¡¨å• */}
    </div>
  );
}
```

**å·¥æ—¶**ï¼š1å¤©

### 5.5 ç§»åŠ¨ç«¯åŠ©æ•™ä½“éªŒä¼˜åŒ–

**æ”¹åŠ¨ç‚¹**ï¼š
1. åº•éƒ¨å¯¼èˆªæ ï¼ˆç§»åŠ¨ç«¯ï¼‰
2. æ‰‹åŠ¿æ“ä½œæ”¯æŒ
3. å…³é”®æ“ä½œå¤§æŒ‰é’®

**æ–°å»ºæ–‡ä»¶**ï¼š`app/coach/_components/MobileNav.tsx`

```tsx
"use client";

import Link from "next/link";
import { usePathname } from "next/navigation";

const mobileNavItems = [
  { href: "/coach/dashboard", label: "å®¢æˆ·", icon: "ğŸ‘¥" },
  { href: "/coach/invites", label: "é‚€è¯·", icon: "ğŸ“¨" },
  { href: "/coach/invites/new", label: "æ–°å»º", icon: "â•", primary: true },
];

export function MobileNav() {
  const pathname = usePathname();
  
  return (
    <nav className="lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t 
                  safe-area-inset-bottom">
      <div className="flex justify-around items-center h-16">
        {mobileNavItems.map(item => {
          const active = pathname?.startsWith(item.href);
          return (
            <Link
              key={item.href}
              href={item.href}
              className={`flex flex-col items-center justify-center w-16 h-full
                        ${item.primary 
                          ? 'bg-blue-600 text-white rounded-full w-14 h-14 -mt-4 shadow-lg' 
                          : active ? 'text-blue-600' : 'text-gray-500'
                        }`}
            >
              <span className="text-xl">{item.icon}</span>
              {!item.primary && (
                <span className="text-xs mt-0.5">{item.label}</span>
              )}
            </Link>
          );
        })}
      </div>
    </nav>
  );
}
```

**å·¥æ—¶**ï¼š1å¤©

### v2.1 ä»»åŠ¡æ¸…å•

| ä»»åŠ¡ | å·¥æ—¶ | è´Ÿè´£ | éªŒæ”¶æŒ‡æ ‡ |
|------|------|------|----------|
| å®¢æˆ·ç­›é€‰å™¨ | 3d | å‰ç«¯+åç«¯ | ç­›é€‰æ•ˆç‡+50% |
| é«˜é£é™©ç”¨æˆ·é¢„è­¦ | 2d | å‰ç«¯ | å“åº”ç‡+30% |
| æ‰¹é‡æ“ä½œ | 3d | å‰ç«¯+åç«¯ | æ‰¹é‡æ“ä½œå¯ç”¨ |
| è·Ÿè¿›è®°å½•æ¨¡æ¿ | 1d | å‰ç«¯ | è®°å½•æ•ˆç‡+30% |
| ç§»åŠ¨ç«¯åŠ©æ•™ä½“éªŒ | 1d | å‰ç«¯ | ç§»åŠ¨ç«¯å¯ç”¨æ€§ |
| **æ€»è®¡** | **10d** | | |

---

## å…­ã€v2.2 ç³»ç»Ÿå¥å£®ï¼ˆ2å‘¨ï¼‰

### ç›®æ ‡
- é…ç½®å›æ»šæˆåŠŸç‡ 100%
- æ–°äººä¸Šæ‰‹æ—¶é—´ä» 3 å¤©é™åˆ° 1 å¤©
- é…ç½®è¯¯æ“ä½œç‡ -90%

### 6.1 é…ç½®ç‰ˆæœ¬ç®¡ç†

**æ–°å»ºè¡¨**ï¼š`prisma/schema.prisma`

```prisma
model ConfigVersion {
  id          String   @id @default(cuid())
  configType  String   @map("config_type")  // "sop" | "script" | "training"
  configId    String   @map("config_id")
  version     Int      @default(1)
  dataJson    String   @map("data_json") @db.Text  // é…ç½®å¿«ç…§
  changedBy   String   @map("changed_by")
  changeNote  String?  @map("change_note")
  createdAt   DateTime @default(now()) @map("created_at")

  @@index([configType, configId, version])
  @@map("config_versions")
}
```

**API**ï¼š
- `GET /api/admin/config/versions?type=sop&id=xxx` - è·å–ç‰ˆæœ¬å†å²
- `POST /api/admin/config/rollback` - å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬

**UI**ï¼šåœ¨ç­–ç•¥ä¸­å¿ƒå¢åŠ "ç‰ˆæœ¬å†å²"æŒ‰é’®

**å·¥æ—¶**ï¼š3å¤©

### 6.2 é…ç½®å¯¼å…¥å¯¼å‡º

**API**ï¼š
- `GET /api/admin/config/export?type=sop` - å¯¼å‡º JSON
- `POST /api/admin/config/import` - å¯¼å…¥ JSON

**å¯¼å‡ºæ ¼å¼**ï¼š

```json
{
  "exportedAt": "2026-01-09T10:00:00Z",
  "version": "1.0",
  "type": "sop",
  "data": {
    "definitions": [...],
    "rules": [...],
    "scripts": [...]
  }
}
```

**å·¥æ—¶**ï¼š2å¤©

### 6.3 æƒé™ä½“ç³»æ‰©å±•

**ä¿®æ”¹æ–‡ä»¶**ï¼š`lib/rbac.ts`

```typescript
export const ROLES = {
  super_admin: {
    name: "è¶…çº§ç®¡ç†å‘˜",
    permissions: ["*"],
  },
  content_admin: {
    name: "å†…å®¹ç®¡ç†å‘˜",
    permissions: [
      "quiz:*",
      "archetype:*",
      "training_handbook:*",
      "methodology:*",
      "audit:read",
    ],
  },
  strategy_admin: {
    name: "ç­–ç•¥ç®¡ç†å‘˜",
    permissions: [
      "sop:*",
      "script:*",
      "training_plan:*",
      "audit:read",
    ],
  },
  coach_manager: {
    name: "åŠ©æ•™ä¸»ç®¡",
    permissions: [
      "coach:read",
      "coach:assign",
      "customer:read_all",
      "dashboard:read",
    ],
  },
  coach: {
    name: "åŠ©æ•™",
    permissions: [
      "customer:own",
      "invite:own",
      "followup:own",
    ],
  },
};

export function hasPermission(role: string, permission: string): boolean {
  const roleConfig = ROLES[role as keyof typeof ROLES];
  if (!roleConfig) return false;
  
  if (roleConfig.permissions.includes("*")) return true;
  
  // æ”¯æŒé€šé…ç¬¦åŒ¹é…
  return roleConfig.permissions.some(p => {
    if (p.endsWith(":*")) {
      const prefix = p.slice(0, -2);
      return permission.startsWith(prefix + ":");
    }
    return p === permission;
  });
}
```

**æ•°æ®åº“æ”¹åŠ¨**ï¼šUser è¡¨å¢åŠ  permissions å­—æ®µï¼ˆå¯é€‰ï¼Œç”¨äºç»†ç²’åº¦æƒé™ï¼‰

**å·¥æ—¶**ï¼š3å¤©

### 6.4 é…ç½®å†²çªæ£€æµ‹

**æ–°å»ºæ–‡ä»¶**ï¼š`lib/config-validator.ts`

```typescript
interface ValidationResult {
  valid: boolean;
  warnings: string[];
  errors: string[];
}

/**
 * æ£€æµ‹ SOP è§„åˆ™å†²çª
 */
export async function validateSopRules(
  prisma: PrismaClient,
  sopId: string
): Promise<ValidationResult> {
  const rules = await prisma.sopRule.findMany({
    where: { sopId, status: "active" },
  });
  
  const warnings: string[] = [];
  const errors: string[] = [];
  
  // æ£€æµ‹è§„åˆ™é‡å 
  for (let i = 0; i < rules.length; i++) {
    for (let j = i + 1; j < rules.length; j++) {
      const overlap = checkRuleOverlap(rules[i], rules[j]);
      if (overlap) {
        warnings.push(
          `è§„åˆ™ "${rules[i].ruleId}" å’Œ "${rules[j].ruleId}" å­˜åœ¨é‡å ï¼Œ` +
          `å¯èƒ½å¯¼è‡´åŒ¹é…ä¸ç¡®å®š`
        );
      }
    }
  }
  
  // æ£€æµ‹æ— æ•ˆæ ‡ç­¾
  for (const rule of rules) {
    const requiredTags = JSON.parse(rule.requiredTagsJson || "[]");
    for (const tag of requiredTags) {
      if (!isValidTag(tag)) {
        errors.push(`è§„åˆ™ "${rule.ruleId}" åŒ…å«æ— æ•ˆæ ‡ç­¾: ${tag}`);
      }
    }
  }
  
  return {
    valid: errors.length === 0,
    warnings,
    errors,
  };
}

/**
 * æ£€æµ‹è¯æœ¯ä¸ SOP çš„ä¸€è‡´æ€§
 */
export async function validateScriptSopConsistency(
  prisma: PrismaClient,
  scriptId: string
): Promise<ValidationResult> {
  const script = await prisma.scriptTemplate.findUnique({
    where: { id: scriptId },
    include: { sop: true },
  });
  
  const warnings: string[] = [];
  
  if (script?.sop) {
    // æ£€æŸ¥è¯æœ¯çš„ triggerStage æ˜¯å¦ä¸ SOP çš„ sopStage ä¸€è‡´
    if (script.triggerStage && script.triggerStage !== script.sop.sopStage) {
      warnings.push(
        `è¯æœ¯çš„è§¦å‘é˜¶æ®µ (${script.triggerStage}) ä¸å…³è” SOP çš„é˜¶æ®µ ` +
        `(${script.sop.sopStage}) ä¸ä¸€è‡´`
      );
    }
  }
  
  return {
    valid: true,
    warnings,
    errors: [],
  };
}
```

**å·¥æ—¶**ï¼š2å¤©

### v2.2 ä»»åŠ¡æ¸…å•

| ä»»åŠ¡ | å·¥æ—¶ | è´Ÿè´£ | éªŒæ”¶æŒ‡æ ‡ |
|------|------|------|----------|
| é…ç½®ç‰ˆæœ¬ç®¡ç† | 3d | åç«¯+å‰ç«¯ | å›æ»šæˆåŠŸç‡ 100% |
| é…ç½®å¯¼å…¥å¯¼å‡º | 2d | åç«¯ | å¯¼å…¥å¯¼å‡ºå¯ç”¨ |
| æƒé™ä½“ç³»æ‰©å±• | 3d | åç«¯ | 5çº§æƒé™å¯ç”¨ |
| é…ç½®å†²çªæ£€æµ‹ | 2d | åç«¯ | å†²çªæ£€æµ‹å‡†ç¡®ç‡ >90% |
| **æ€»è®¡** | **10d** | | |

---

## ä¸ƒã€ç”¨æˆ·ç«¯ç§»åŠ¨ä¼˜åŒ–ï¼ˆè´¯ç©¿å„ç‰ˆæœ¬ï¼‰

### 7.1 è½åœ°é¡µç§»åŠ¨ä¼˜åŒ–

**æ”¹åŠ¨æ–‡ä»¶**ï¼š`app/t/[token]/page.tsx`

```tsx
// ç§»åŠ¨ç«¯é¦–å±å®Œæ•´å±•ç¤º
<div className="min-h-screen flex flex-col">
  {/* é¦–å±å†…å®¹ */}
  <div className="flex-1 flex flex-col justify-center px-4 py-8">
    <h1 className="text-2xl lg:text-3xl font-bold text-center mb-4">
      3åˆ†é’Ÿï¼Œçœ‹æ¸…ä½ ç‚’è‚¡æ—¶æœ€å®¹æ˜“åœ¨å“ªä¸€æ­¥ä¹±åŠ¨
    </h1>
    
    <p className="text-gray-600 text-center mb-8">
      å®Œæˆæµ‹è¯„åï¼Œä½ çš„ä¸“å±åŠ©æ•™ä¼šå¸®ä½ è§£è¯»ç»“æœ
    </p>
    
    {/* åŠ©æ•™ä¿¡æ¯å¡ç‰‡ */}
    <div className="bg-white rounded-xl shadow-lg p-6 mb-8">
      <div className="flex items-center gap-4">
        {coach.wechatQrcode && (
          <Image
            src={coach.wechatQrcode}
            alt="åŠ©æ•™å¤´åƒ"
            width={60}
            height={60}
            className="rounded-full"
          />
        )}
        <div>
          <div className="font-medium">{coach.name || 'ä¸“å±åŠ©æ•™'}</div>
          <div className="text-sm text-gray-500">å°†ä¸ºä½ è§£è¯»æµ‹è¯„ç»“æœ</div>
        </div>
      </div>
    </div>
    
    {/* å¼€å§‹æŒ‰é’®ï¼ˆå¤§æŒ‰é’®ï¼Œç§»åŠ¨ç«¯å‹å¥½ï¼‰ */}
    <button
      onClick={handleStart}
      className="w-full py-4 bg-blue-600 text-white text-lg font-medium 
               rounded-xl shadow-lg active:bg-blue-700 transition-colors"
    >
      å¼€å§‹æµ‹è¯„
    </button>
  </div>
  
  {/* åº•éƒ¨åˆè§„æç¤º */}
  <div className="px-4 py-3 text-center text-xs text-gray-400">
    æœ¬æµ‹è¯„å¸®ä½ çœ‹æ¸…æ“ä½œä¹ æƒ¯ï¼Œä¸æ¶‰åŠæŠ•èµ„å»ºè®®
  </div>
</div>
```

### 7.2 æµ‹è¯„é¡µç§»åŠ¨ä¼˜åŒ–

**æ”¹åŠ¨æ–‡ä»¶**ï¼š`app/t/[token]/quiz/page.tsx`

```tsx
// å•é¢˜å•å±ï¼Œå¤§æŒ‰é’®é€‰é¡¹
<div className="min-h-screen flex flex-col bg-gray-50">
  {/* è¿›åº¦æ¡ï¼ˆå›ºå®šé¡¶éƒ¨ï¼‰ */}
  <div className="sticky top-0 bg-white shadow-sm p-4 z-10">
    <div className="flex justify-between text-sm text-gray-600 mb-2">
      <span>ç¬¬ {current + 1} / {total} é¢˜</span>
      <span>é¢„è®¡è¿˜éœ€ {estimatedMinutes} åˆ†é’Ÿ</span>
    </div>
    <div className="h-2 bg-gray-200 rounded-full overflow-hidden">
      <div
        className="h-full bg-blue-600 transition-all duration-300"
        style={{ width: `${((current + 1) / total) * 100}%` }}
      />
    </div>
  </div>
  
  {/* é¢˜ç›®å†…å®¹ */}
  <div className="flex-1 flex flex-col p-4">
    <div className="flex-1 flex items-center">
      <h2 className="text-lg lg:text-xl font-medium leading-relaxed">
        {question.stem}
      </h2>
    </div>
    
    {/* é€‰é¡¹ï¼ˆå¤§æŒ‰é’®ï¼‰ */}
    <div className="space-y-3 pb-safe">
      {question.options.map((option, index) => (
        <button
          key={option.id}
          onClick={() => handleAnswer(option.id)}
          className={`w-full p-4 text-left rounded-xl border-2 transition-all
                    ${selected === option.id
                      ? 'border-blue-600 bg-blue-50'
                      : 'border-gray-200 bg-white active:border-blue-300'
                    }`}
        >
          <span className="text-gray-400 mr-2">{['A', 'B', 'C', 'D'][index]}.</span>
          {option.text}
        </button>
      ))}
    </div>
  </div>
</div>
```

### 7.3 ç»“æœé¡µç§»åŠ¨ä¼˜åŒ–

**æ”¹åŠ¨æ–‡ä»¶**ï¼š`app/t/[token]/result/page.tsx`

```tsx
// é¦–å±ï¼šç”»åƒ + æ ¸å¿ƒæ´å¯Ÿ + è”ç³»åŠ©æ•™
<div className="min-h-screen bg-gradient-to-b from-blue-50 to-white">
  {/* é¦–å± */}
  <div className="min-h-screen flex flex-col p-4">
    {/* ç”»åƒæ ‡é¢˜ */}
    <div className="flex-1 flex flex-col justify-center text-center">
      <div className="text-6xl mb-4">
        {ARCHETYPE_ICONS[archetype.key]}
      </div>
      <h1 className="text-2xl lg:text-3xl font-bold mb-2">
        ä½ æ˜¯ã€Œ{archetype.titleCn}ã€
      </h1>
      <p className="text-gray-600 text-lg mb-8">
        "{archetype.oneLinerCn}"
      </p>
      
      {/* æ ¸å¿ƒæ´å¯Ÿï¼ˆæœ€å¤š2ä¸ªï¼‰ */}
      <div className="space-y-3 mb-8">
        {highlights.slice(0, 2).map(h => (
          <div
            key={h.tag}
            className="bg-white rounded-xl p-4 shadow-sm text-left"
          >
            <div className="font-medium text-blue-900">{h.labelCn}</div>
            <div className="text-sm text-gray-600 mt-1">{h.explanationCn}</div>
          </div>
        ))}
      </div>
    </div>
    
    {/* è”ç³»åŠ©æ•™ï¼ˆå›ºå®šåº•éƒ¨ï¼‰ */}
    <div className="space-y-3 pb-safe">
      <p className="text-center text-gray-600">
        æƒ³çŸ¥é“æ€ä¹ˆç”¨å¥½è¿™ä¸ªç‰¹ç‚¹ï¼Ÿ
      </p>
      <button
        onClick={handleContact}
        className="w-full py-4 bg-blue-600 text-white text-lg font-medium 
                 rounded-xl shadow-lg active:bg-blue-700"
      >
        è”ç³»åŠ©æ•™ {coach.name} è·å–è§£è¯»
      </button>
      {coach.wechatQrcode && (
        <div className="text-center">
          <button
            onClick={() => setShowQR(true)}
            className="text-blue-600 text-sm"
          >
            æ‰«ç æ·»åŠ å¾®ä¿¡
          </button>
        </div>
      )}
    </div>
  </div>
  
  {/* è¯¦ç»†æŠ¥å‘Šï¼ˆæ»šåŠ¨æŸ¥çœ‹ï¼‰ */}
  <div className="p-4">
    <details className="bg-white rounded-xl shadow-sm">
      <summary className="p-4 cursor-pointer font-medium">
        æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š â–¼
      </summary>
      <div className="p-4 border-t">
        {/* åŸæœ‰çš„è¯¦ç»†å†…å®¹ */}
      </div>
    </details>
  </div>
</div>
```

---

## å…«ã€é‡Œç¨‹ç¢‘ä¸éªŒæ”¶

| ç‰ˆæœ¬ | å®Œæˆæ—¥æœŸ | æ ¸å¿ƒéªŒæ”¶æŒ‡æ ‡ |
|------|----------|--------------|
| v1.9 | W1 | Adminå¯¼èˆªå®Œæ•´åº¦100%ï¼Œè¯æœ¯ä½¿ç”¨ç‡+20% |
| v2.0 | W3 | é…ç½®å…¥å£å‡å°‘50%ï¼Œé…ç½®å†²çªç‡-80% |
| v2.1 | W5 | åŠ©æ•™ç­›é€‰æ•ˆç‡+50%ï¼Œé«˜é£é™©å“åº”ç‡+30% |
| v2.2 | W7 | é…ç½®å›æ»šå¯ç”¨ï¼Œæƒé™ä½“ç³»å®Œæ•´ |

### å…³é”®æŒ‡æ ‡è¿½è¸ª

| æŒ‡æ ‡ | å½“å‰å€¼ | v1.9ç›®æ ‡ | v2.0ç›®æ ‡ | v2.1ç›®æ ‡ | v2.2ç›®æ ‡ |
|------|--------|----------|----------|----------|----------|
| Adminå¯¼èˆªå®Œæ•´åº¦ | 70% | 100% | 100% | 100% | 100% |
| è¯æœ¯ä½¿ç”¨ç‡ | åŸºå‡† | +20% | +30% | +40% | +40% |
| é…ç½®å…¥å£æ•° | 4ä¸ª | 4ä¸ª | 2ä¸ª | 2ä¸ª | 2ä¸ª |
| åŠ©æ•™ç­›é€‰æ•ˆç‡ | åŸºå‡† | åŸºå‡† | åŸºå‡† | +50% | +50% |
| é«˜é£é™©å“åº”ç‡ | åŸºå‡† | åŸºå‡† | åŸºå‡† | +30% | +30% |
| é…ç½®è¯¯æ“ä½œç‡ | åŸºå‡† | åŸºå‡† | -50% | -70% | -90% |
| ç§»åŠ¨ç«¯æµ‹è¯„å®Œæˆç‡ | åŸºå‡† | +10% | +15% | +20% | +20% |

---

## ä¹ã€é£é™©ä¸åº”å¯¹

| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|------|------|------|----------|
| ç­–ç•¥ä¸­å¿ƒå¼€å‘å¤æ‚åº¦é«˜ | ä¸­ | é«˜ | åˆ†é˜¶æ®µäº¤ä»˜ï¼Œå…ˆå®Œæˆæ ¸å¿ƒåŠŸèƒ½ |
| æ•°æ®è¿ç§»é£é™© | ä½ | é«˜ | å……åˆ†æµ‹è¯•ï¼Œä¿ç•™æ—§å…¥å£å…¼å®¹ |
| ç§»åŠ¨ç«¯é€‚é…å·¥ä½œé‡å¤§ | ä¸­ | ä¸­ | ä¼˜å…ˆæ ¸å¿ƒé¡µé¢ï¼Œæ¸è¿›å¢å¼º |
| æƒé™æ‰©å±•å½±å“ç°æœ‰ç”¨æˆ· | ä½ | ä¸­ | é»˜è®¤ä¿æŒç°æœ‰æƒé™ä¸å˜ |

---

## åã€æ–‡ä»¶å˜æ›´æ¸…å•

### v1.9
```
app/admin/_components/AdminNav.tsx      # å¯¼èˆªé‡ç»„
app/admin/page.tsx                      # é‡å®šå‘åˆ°æ•°æ®çœ‹æ¿
app/coach/clients/[id]/page.tsx         # ä¿¡æ¯åˆ†å±‚
app/coach/clients/[id]/_components/ScriptPanel.tsx  # è¯æœ¯ä¼˜åŒ–
app/coach/_components/TodoPanel.tsx     # é»˜è®¤å±•å¼€
lib/ui-copy.ts                          # åˆè§„æ–‡æ¡ˆ
app/admin/sop/page.tsx                  # æ–‡æ¡ˆä¼˜åŒ–
app/admin/scripts/page.tsx              # æ–‡æ¡ˆä¼˜åŒ–
```

### v2.0
```
app/admin/strategy/page.tsx             # æ–°å»ºï¼šç­–ç•¥ä¸­å¿ƒ
app/api/admin/strategy/preview/route.ts # æ–°å»ºï¼šå½±å“é¢„è§ˆ
prisma/schema.prisma                    # è¯æœ¯å…³è”SOP
app/api/coach/scripts/route.ts          # åŒ¹é…é€»è¾‘é‡æ„
```

### v2.1
```
app/coach/dashboard/page.tsx            # ç­›é€‰å™¨+æ‰¹é‡æ“ä½œ
app/api/coach/customers/route.ts        # ç­›é€‰API
app/api/coach/customers/batch/route.ts  # æ–°å»ºï¼šæ‰¹é‡æ“ä½œ
app/coach/clients/[id]/page.tsx         # é«˜é£é™©é¢„è­¦
app/coach/_components/MobileNav.tsx     # æ–°å»ºï¼šç§»åŠ¨å¯¼èˆª
```

### v2.2
```
prisma/schema.prisma                    # ConfigVersionè¡¨
app/api/admin/config/versions/route.ts  # æ–°å»ºï¼šç‰ˆæœ¬å†å²
app/api/admin/config/rollback/route.ts  # æ–°å»ºï¼šå›æ»š
app/api/admin/config/export/route.ts    # æ–°å»ºï¼šå¯¼å‡º
app/api/admin/config/import/route.ts    # æ–°å»ºï¼šå¯¼å…¥
lib/rbac.ts                             # æƒé™æ‰©å±•
lib/config-validator.ts                 # æ–°å»ºï¼šå†²çªæ£€æµ‹
```

---

*è®¡åˆ’åˆ¶å®šæ—¥æœŸï¼š2026-01-09*
*è®¡åˆ’ç‰ˆæœ¬ï¼šv2.0*
*æ€»å·¥æœŸï¼š7å‘¨*
